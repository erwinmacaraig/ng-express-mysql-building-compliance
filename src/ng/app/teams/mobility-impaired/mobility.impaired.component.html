<div class="row">
	<div class="col l12 m12 s12" style="position: relative;">
		<h4>Mobility Impaired</h4>
		<a href="#" class="archived" [routerLink]="['/teams/mobility-impaired-archived']">
			<span class="image"></span>
			View Archive
		</a>
	</div>
</div>

<div class="row filter-container">
	<div class="col l2 m3 s12 ">
		<button class="btn orange waves-effect waves-light add-peep" [routerLink]="['/teams/add-mobility-impaired']">
			<span class="image"></span>
			Add P.E.E.P
		</button>
	</div>

	<div class="col l4 m5 s12">
		<div class="search-field">
			<input type="text" placeholder="Search member name or email" id="searchMemberInput">
			<span class="material-icons">search</span>
		</div>
	</div>

	<div class="col l2 m4 s6">
		<select class="filter-by">
			<option value="0" selected>Filter By (All)</option>
			<option value="incomplete">Needs peep completion</option>
			<option value="completed">Peep completed</option>
			<option value="user-validation-needed">User validation needed</option>
		</select>
	</div>

	<div class="col l2 m6 s6">
		<select class="sort-by">
			<option value="0" selected>Sort By</option>
			<option value="loc-name-desc">Location Name Descending</option>
			<option value="loc-name-asc">Location Name Ascending</option>
			<option value="user-name-desc">User Name Descending</option>
			<option value="user-name-asc">User Name Ascending</option>
		</select>
	</div>
	<div class="col l2 m6 s12">
		<select class="bulk-manage">
			<option value="0" selected>Manage Action</option>
			<option value="archive" >Archive selected</option>
		</select>
	</div>

</div>


<div class="row">
	<div class="col l12 m12 s12">

		<table class="table striped table-peep">
			<thead>
				<tr>
					<th>
						<p class="checkbox">
							<input id="allLocations" (change)="selectAllCheckboxEvent($event)" class="filled-in" type="checkbox">
							<label for="allLocations">Locations</label>
						</p>
					</th>
					<th>Name</th>
					<th>PEEP Completion</th>
					<th>PEEP Review Date</th>
					<th>Last Login</th>
					<th>Action</th>
				</tr>
			</thead>
			<tbody [hidden]="loadingTable">
				<tr *ngIf="peepList.length == 0">
					<td colspan="6" class="center">
						<h6>No record found</h6>
					</td>
				</tr>
				<tr *ngFor="let peep of peepList; let i = index;">
					<td>
						<p class="checkbox" >
							<input id="location-{{i}}"  class="filled-in" type="checkbox" (change)="singleCheckboxChangeEvent(peep, $event)"  >
							<label for="location-{{i}}" >
								<span *ngIf="peep.locations.length > 1">Multiple locations</span>
								<span *ngIf="peep.locations.length == 1">
									<span *ngIf="peep.locations[0].parent_name.trim().length > 0">{{ peep.locations[0].parent_name }}, </span>
									{{peep.locations[0].name}}
								</span>
							</label>
						</p>
					</td>
					<td>
						<div class="image-container lighten-3" [ngClass]="peep.bg_class">
							<div class="image">
								<img *ngIf="peep.profile_pic.length > 0" [src]="peep.profile_pic"  >
							</div>
						</div>
						<div class="text">
							<a *ngIf="peep.user_id" [routerLink]="['/teams/view-user/', peep.id_encrypted]">
								{{peep.first_name}} {{peep.last_name}}
							</a>
							<span *ngIf="!peep.user_id">{{peep['first_name']}} {{peep['last_name']}}</span>
						</div>
					</td>
					<td class="peep-completion">
						<span *ngIf="peep.mobility_impaired_details.length > 0">
							<a href="javascipt:void(0)" class="view-peep-link" [attr.user_id]="peep.user_id" [attr.user_invitations_id]="peep.user_invitations_id">View</a>
						</span>
						<a href="javascipt:void(0)" (click)="clickCompletePeepInfo(peep)" 
						*ngIf="peep.mobility_impaired_details.length == 0" >Complete peep information</a>
						<span *ngIf="!peep.user_id"> Waiting for user validation </span>
					</td>
					<!-- <td class="trainings">
						<div class="percent">0%</div>
						<div class="bar"></div>
					</td> -->
					<td>
						<span *ngIf="peep.mobility_impaired_details[0]">{{peep.mobility_impaired_details[0].date_created}}</span>
						<span *ngIf="!peep.mobility_impaired_details[0]"> - </span>
					</td>
					<td>
						<span *ngIf="!peep.id_encrypted">processing</span>
						<span *ngIf="peep.id_encrypted">{{peep.last_login}}</span>
					</td>
					<td>
						<select (change)="onSelectFromTable($event, peep)" >
							<option value="0" class="blue-text" selected disabled>Manage</option>
							<option value="view" class="blue-text" *ngIf="peep.id_encrypted">View</option>
							<option value="archive" class="blue-text" *ngIf="peep.user_id != userData.userId">Archive</option>
							<option value="archive" class="blue-text" *ngIf="peep.user_invitations_id > 0">Archive</option>
						</select>
					</td>
				</tr>
			</tbody>
			<tbody [hidden]="!loadingTable">
				<tr>
					<td colspan="7" class="center-align">
						<h6>Fetching records..</h6>
					</td>
				</tr>
			</tbody>
		</table>

	</div>

</div>

<div class="row">
	<div class="col l12 m12 s12 center pagination" [hidden]="peepList.length == 0">
		<div class="inline-block">
			<button class="btn blue" (click)="pageChange('prev')" > Prev </button>
		</div>

		<div class="inline-block select">
			<select #selectPage ngModel [(ngModel)]="pagination.currentPage" (change)="pageChange(selectPage.value)">
				<option *ngFor="let sel of pagination.selection" value="{{sel.number}}">{{sel.number}}</option>
			</select>
		</div>

		<div class="inline-block">
			<button class="btn blue" (click)="pageChange('next')" > Next </button>
		</div>
	</div>
</div>


<div id="modalArchive" class="modal">
	<div class="modal-content center" [hidden]="!showModalLoader">
		<div class="preloader-wrapper active">
			<div class="spinner-layer spinner-red-only">
				<div class="circle-clipper left">
					<div class="circle"></div>
				</div><div class="gap-patch">
					<div class="circle"></div>
				</div><div class="circle-clipper right">
					<div class="circle"></div>
				</div>
			</div>
		</div>
	</div>
	<div class="modal-content" [hidden]="showModalLoader">
		<h5>Confirmation</h5>
		<p style="font-size: 16px;">
			Are you sure you want archive 
			<!-- <span *ngIf="selectedToArchive.parent_name">
				{{ selectedToArchive.parent_name }}, 
			</span> 
			<span>{{selectedToArchive.name}} </span> -->
			<span class="blue-text">{{selectedToArchive.first_name}} {{selectedToArchive.last_name}}</span>
		</p>
	</div>
	<div class="modal-footer" [hidden]="showModalLoader">
		<a href="javascipt:void(0)" class="modal-action modal-close waves-effect waves-red btn-flat">Cancel</a>
		<a href="javascipt:void(0)" class="waves-effect waves-blue btn-flat" (click)="archiveClick()">Archive</a>
	</div>
</div>

<div id="modalArchiveBulk" class="modal">
	<div class="modal-content center" [hidden]="!showModalLoader">
		<div class="preloader-wrapper active">
			<div class="spinner-layer spinner-red-only">
				<div class="circle-clipper left">
					<div class="circle"></div>
				</div><div class="gap-patch">
					<div class="circle"></div>
				</div><div class="circle-clipper right">
					<div class="circle"></div>
				</div>
			</div>
		</div>
	</div>
	<div class="modal-content" [hidden]="showModalLoader">
		<h5>Confirmation</h5>
		<p style="font-size: 16px;">
			Are you sure you want restore the following items?
		</p>
		<ul>
			<li *ngFor="let list of selectedFromList;">
				<!-- <span *ngIf="list.parent_name">
					{{ list.parent_name }}, 
				</span> 
				<span>{{list.name}}</span>  -->
				<span class="blue-text">{{list.first_name}} {{list.last_name}}</span>
			</li>
		</ul>
	</div>
	<div class="modal-footer" [hidden]="showModalLoader">
		<a href="javascipt:void(0)" class="modal-action modal-close waves-effect waves-red btn-flat">Cancel</a>
		<a href="javascipt:void(0)" class="waves-effect waves-blue btn-flat" (click)="bulkArchiveClick()">Archive</a>
	</div>
</div>

<div id="modalMobility" class="modal">

	<div class="modal-content center" [hidden]="!showModalLoader">
		<div class="preloader-wrapper active">
			<div class="spinner-layer spinner-red-only">
				<div class="circle-clipper left">
					<div class="circle"></div>
				</div><div class="gap-patch">
					<div class="circle"></div>
				</div><div class="circle-clipper right">
					<div class="circle"></div>
				</div>
			</div>
		</div>
	</div>
	
	<form #formMobility="ngForm" (submit)="modalPeepFormSubmit(formMobility, $event)" [hidden]="showModalLoader">

	<div class="modal-content">
		<h5>Mobility Impaired Information</h5>
		<div class="row">
			<div class="col s12 l6 m6">
				<div class="select-field">
					<span style=" font-size: 16px;">Mobility Impaired Status</span>
					<select ngModel name="is_permanent">
						<option value="0" selected="selected">Temporary</option>
						<option value="1" >Permanent</option>
					</select>
				</div>
			</div>
			<div class="col s12 l6 m6">
				<div class="input-field">
					<span style=" font-size: 16px;">Mobility Impaired Upto</span>
					<ng-datepicker [(ngModel)]="datepickerModel" (ngModelChange)="onChangeDatePicker($event)"  [ngModelOptions]="{standalone: true}" [headless]="true" [isOpened]="isShowDatepicker" ></ng-datepicker>
					<input id="durationDate" #durationDate type="text" [(ngModel)]="datepickerModelFormatted" ngModel name="duration_date" (click)="showDatePicker()" required >
				</div>

			</div>
			<div class="col s12 m12 l12">
				<h6>Assistant Type</h6>
				<input ngModel name="assistant_type" type="text" class="grey-input" placeholder="Please describe requirements and process here." required>
			</div>
			<div class="col s12 m12 l12">
				<h6>Evacuation Equipment Type / Requirement</h6>
				<input ngModel name="equipment_type" type="text" class="grey-input" placeholder="Please inform what is the equiment and type." required>
			</div>
			<div class="col s12 m12 l12">
				<h6>Evacuation / Egress Procedure</h6>
				<input ngModel name="evacuation_procedure" type="text" class="grey-input" placeholder="" required>
			</div>
		</div>

		<div class="row button-container">
			<div class="col s12 m12 l12">
				<a href="javascipt:void(0)" class="btn grey lighten-1 waves-light waves-effect modal-close">Cancel</a>
				<button class="btn orange waves-light waves-effect" [disabled]="formMobility.invalid">Submit</button>
			</div>
		</div>
	</div>


	</form>
</div>